# tests use the simulator so they can't run in parallel
# see https://gitlab.com/gitlab-org/gitlab/issues/15536 for future support of locks
stages:
  - int-test

.common:
  stage: int-test
  resource_group: "ios-simulator"
  tags: [mac, x64, xcode]

latest:
  extends: .common
  script:
    - ./test.sh
    - ./test.sh --clean -v 1.8.1
    - ./test.sh --clean -v 1.8.1-sync

2nd-latest:
  extends: .common
  script:
    - ./test.sh
    - ./test.sh --clean -v 1.8.0
    - ./test.sh --clean -v 1.8.0-sync

# Disable until current Swift version is supported again
.latest-carthage:
  extends: .common
  script:
    - ./test.sh --carthage-bin
    - ./test.sh --clean --carthage-bin -v 1.8.1

# If there's a staging release... (otherwise, disabled via leading '.')
carthage-staging:
  extends: .common
  script:
    - ./test.sh --staging --carthage -v 1.9.0-rc
